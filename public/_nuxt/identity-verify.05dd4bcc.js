import{g as w,s as I,h as U,i as S,K as b,o as v,c as g,a as s,n as h,t as V,r as F,k as n,L as k,_ as C,A as q,V as D,l as R,b as c,w as B,H as P,N as j,M as L,Q as N}from"./entry.e0bca97a.js";const z=["for","textContent"],A={key:0},H=["src"],M={key:1,class:"p-c text-xs"},Q=["id","required"],E=w({__name:"Image",props:{modelValue:{type:String,default:""},label:{type:String,default:""},id:{type:String,default:""},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{emit:o}){const t=I(""),l=U({lg:"text-base",md:"text-sm",sm:"text-xs",xs:"text-xs"}),u=S(()=>l.md),i=b("message"),f=async e=>{const a=new FormData;a.append("file",e);const{data:_,error:d,message:p}=await k("/comm/upload",{body:a,multipart:!0});return d?i.value=p:_},m=async e=>{const a=e.target;if(a.files&&a.files[0]){const _=await f(a.files[0]);o("update:modelValue",_);const d=new FileReader;d.onload=p=>{var x;t.value=((x=p.target)==null?void 0:x.result)||""},d.readAsDataURL(a.files[0])}};return(e,a)=>(v(),g("div",null,[s("div",{class:h(["flex items-center mb-2",n(u)])},[s("label",{for:r.id,class:h(["block font-bold tracking-wide",[{"cursor-pointer":r.id}]]),textContent:V(r.label)},null,10,z),F(e.$slots,"label",{},void 0,!0)],2),s("div",{class:h(["relative border border-gray-300 border-opacity-40 rounded dark:bg-white/[0.05] bg-gray-100",{model:!n(t)}])},[n(t).length>0?(v(),g("div",A,[s("img",{class:"preview w-full h-full",src:n(t)},null,8,H)])):(v(),g("div",M," 點擊上傳圖片 ")),s("input",{id:r.id,type:"file",accept:"image/*",class:"absolute w-full h-full cursor-pointer opacity-0 top-0 left-0",required:r.required,onChange:m},null,40,Q)],2)]))}});const K=C(E,[["__scopeId","data-v-d10ebd38"]]),T={class:"container"},G=D('<h1 data-v-cd231830> jQuery Image Upload <small data-v-cd231830>with preview</small></h1><div class="avatar-upload" data-v-cd231830><div class="avatar-edit" data-v-cd231830><input type="file" id="imageUpload" accept=".png, .jpg, .jpeg" data-v-cd231830><label for="imageUpload" data-v-cd231830></label></div><div class="avatar-preview" data-v-cd231830><div id="imagePreview" style="background-image:url(http://i.pravatar.cc/500?img=7);" data-v-cd231830></div></div></div>',2),J=[G],O=w({__name:"Uploader",setup(r){const o=async t=>{if(t.files&&t.files[0]){var l=new FileReader;l.onload=function(u){var i;$("#imagePreview").css("background-image","url("+((i=u.target)==null?void 0:i.result)+")"),$("#imagePreview").hide(),$("#imagePreview").fadeIn(650)},console.log(t.files[0]),l.readAsDataURL(t.files[0])}};return b("message"),q(()=>{$("#imageUpload").on("change",function(){o(this)})}),(t,l)=>(v(),g("div",T,J))}});const W=C(O,[["__scopeId","data-v-cd231830"]]),X={class:"flex items-center justify-between sticky"},Y={class:"flex items-center space-x-2"},Z=s("h1",{class:"text-xl font-bold"},"身份驗證",-1),ee=s("span",{class:"lg:pr-2 duration-150 pr-1"}," 送出 ",-1),te={class:"py-3"},se=w({__name:"identity-verify",setup(r){const o=U({idCard:"",positive:null,negative:null}),t=b("loading"),l=b("alert"),u=R(),i=async()=>{t.value=!0;const{error:m,message:e}=await k("/user/identity-verify",{body:o,multipart:!0});if(t.value=!1,m&&e)return l.value={type:"error",text:e,center:!0};const{user:a}=L();return a.updateField({identityStatus:21,idCard:o.idCard}),l.value={type:"success",text:"送出成功，等待管理員審核",center:!0,action:()=>u.push("/my/account")}},f=()=>{if(!o.positive)return l.value={type:"error",text:"尚未上傳照片",center:!0};i()};return(m,e)=>{const a=P,_=N,d=K,p=W,x=j;return v(),g("div",null,[s("div",X,[s("div",Y,[s("div",{class:"flex items-center cursor-pointer",onClick:e[0]||(e[0]=y=>m.$router.go(-1))},[c(a,{class:"i-ic-round-arrow-back-ios text-sm lg:text-base"})]),Z]),s("div",{class:"group rounded-full cursor-pointer bg-green-500 text-white font-bold px-4 lg:h-9 lg:leading-9 h-7 leading-7 flex items-center lg:text-base text-sm",onClick:f},[ee,c(a,{class:"i-ic-round-arrow-forward-ios"})])]),s("div",te,[c(x,{class:"max-w-[28em]",onSubmit:f},{default:B(()=>[c(_,{modelValue:n(o).idCard,"onUpdate:modelValue":e[1]||(e[1]=y=>n(o).idCard=y),label:"身分證/護照",class:"mb-5",require:!0},null,8,["modelValue"]),c(d,{id:"positive",modelValue:n(o).positive,"onUpdate:modelValue":e[2]||(e[2]=y=>n(o).positive=y),label:"照片",class:"mb-5",require:!0},null,8,["modelValue"]),c(p)]),_:1})])])}}});export{se as default};
