import{g as w,s as I,h as C,i as S,K as y,o as v,c as g,a as s,n as h,t as V,r as F,k as c,L as U,_ as k,A as D,V as R,l as q,b as p,w as B,W as P,H as j,N as L,M as N,Q as z}from"./entry.863f1561.js";const A=["for","textContent"],H={key:0},M=["src"],Q={key:1,class:"p-c text-xs"},E=["id","required"],K=w({__name:"Image",props:{modelValue:{type:String,default:""},label:{type:String,default:""},id:{type:String,default:""},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(u,{emit:a}){const l=I(""),i=C({lg:"text-base",md:"text-sm",sm:"text-xs",xs:"text-xs"}),o=S(()=>i.md),r=y("message"),d=async e=>{const t=new FormData;t.append("file",e);const{data:_,error:m,message:f}=await U("/comm/upload",{body:t,multipart:!0});return m?r.value=f:_},n=async e=>{const t=e.target;if(t.files&&t.files[0]){const _=await d(t.files[0]);a("update:modelValue",_);const m=new FileReader;m.onload=f=>{var b;l.value=((b=f.target)==null?void 0:b.result)||""},m.readAsDataURL(t.files[0])}};return(e,t)=>(v(),g("div",null,[s("div",{class:h(["flex items-center mb-2",c(o)])},[s("label",{for:u.id,class:h(["block font-bold tracking-wide",[{"cursor-pointer":u.id}]]),textContent:V(u.label)},null,10,A),F(e.$slots,"label",{},void 0,!0)],2),s("div",{class:h(["relative border border-gray-300 border-opacity-40 rounded dark:bg-white/[0.05] bg-gray-100",{model:!c(l)}])},[c(l).length>0?(v(),g("div",H,[s("img",{class:"preview w-full h-full",src:c(l)},null,8,M)])):(v(),g("div",Q," 點擊上傳圖片 ")),s("input",{id:u.id,type:"file",accept:"image/*",class:"absolute w-full h-full cursor-pointer opacity-0 top-0 left-0",required:u.required,onChange:n},null,40,E)],2)]))}});const T=k(K,[["__scopeId","data-v-d10ebd38"]]),W={class:"container"},G=R('<h1 data-v-ef1c43fb> jQuery Image Upload <small data-v-ef1c43fb>with preview</small></h1><div class="avatar-upload" data-v-ef1c43fb><div class="avatar-edit" data-v-ef1c43fb><input type="file" id="imageUpload" accept=".png, .jpg, .jpeg" data-v-ef1c43fb><label for="imageUpload" data-v-ef1c43fb></label></div><div class="avatar-preview" data-v-ef1c43fb><div id="imagePreview" style="background-image:url(http://i.pravatar.cc/500?img=7);" data-v-ef1c43fb></div></div></div>',2),J=[G],O=w({__name:"Uploader",setup(u){const a=async o=>{if(o.files&&o.files[0]){var r=new FileReader;r.onload=function(d){var n;$("#imagePreview").css("background-image","url("+((n=d.target)==null?void 0:n.result)+")"),$("#imagePreview").hide(),$("#imagePreview").fadeIn(650)},await i(o.files[0]),r.readAsDataURL(o.files[0])}},l=y("message"),i=async o=>{const r=new FormData;r.append("file",o);const{data:d,error:n,message:e}=await U("/comm/upload",{body:r,multipart:!0});return n?l.value=e:d};return D(()=>{$("#imageUpload").on("change",function(){a(this)})}),(o,r)=>(v(),g("div",W,J))}});const X=k(O,[["__scopeId","data-v-ef1c43fb"]]),Y={class:"flex items-center justify-between sticky"},Z={class:"flex items-center space-x-2"},ee=s("h1",{class:"text-xl font-bold"},"身份驗證",-1),te=s("span",{class:"lg:pr-2 duration-150 pr-1"}," 送出 ",-1),ae={class:"py-3"},oe=w({__name:"identity-verify",setup(u){const a=C({idCard:"",positive:null,negative:null}),l=y("loading"),i=y("alert"),o=q(),r=async()=>{l.value=!0;const{error:n,message:e}=await U("/user/identity-verify",{body:a,multipart:!0});if(l.value=!1,n&&e)return i.value={type:"error",text:e,center:!0};const{user:t}=N();return t.updateField({identityStatus:21,idCard:a.idCard}),i.value={type:"success",text:"送出成功，等待管理員審核",center:!0,action:()=>o.push("/my/account")}},d=()=>{if(!P.test(a.idCard))return i.value={type:"error",text:"身分證格式錯誤",center:!0};if(!a.positive)return i.value={type:"error",text:"尚未上傳照片",center:!0};r()};return(n,e)=>{const t=j,_=z,m=T,f=X,b=L;return v(),g("div",null,[s("div",Y,[s("div",Z,[s("div",{class:"flex items-center cursor-pointer",onClick:e[0]||(e[0]=x=>n.$router.go(-1))},[p(t,{class:"i-ic-round-arrow-back-ios text-sm lg:text-base"})]),ee]),s("div",{class:"group rounded-full cursor-pointer bg-green-500 text-white font-bold px-4 lg:h-9 lg:leading-9 h-7 leading-7 flex items-center lg:text-base text-sm",onClick:d},[te,p(t,{class:"i-ic-round-arrow-forward-ios"})])]),s("div",ae,[p(b,{class:"max-w-[28em]",onSubmit:d},{default:B(()=>[p(_,{modelValue:c(a).idCard,"onUpdate:modelValue":e[1]||(e[1]=x=>c(a).idCard=x),label:"身分證/護照",class:"mb-5",require:!0},null,8,["modelValue"]),p(m,{id:"positive",modelValue:c(a).positive,"onUpdate:modelValue":e[2]||(e[2]=x=>c(a).positive=x),label:"照片",class:"mb-5",require:!0},null,8,["modelValue"]),p(f)]),_:1})])])}}});export{oe as default};
