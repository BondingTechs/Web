import{g as w,s as C,h as k,i as S,K as b,o as v,c as g,a as s,n as h,t as V,r as F,k as d,L as U,_ as I,A as D,V as q,l as R,b as p,w as B,H as P,N as j,M as L,Q as N}from"./entry.871f7ff4.js";const z=["for","textContent"],A={key:0},H=["src"],M={key:1,class:"p-c text-xs"},Q=["id","required"],E=w({__name:"Image",props:{modelValue:{type:String,default:""},label:{type:String,default:""},id:{type:String,default:""},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(c,{emit:o}){const n=C(""),u=k({lg:"text-base",md:"text-sm",sm:"text-xs",xs:"text-xs"}),a=S(()=>u.md),r=b("message"),i=async e=>{const t=new FormData;t.append("file",e);const{data:_,error:m,message:f}=await U("/comm/upload",{body:t,multipart:!0});return m?r.value=f:_},l=async e=>{const t=e.target;if(t.files&&t.files[0]){const _=await i(t.files[0]);o("update:modelValue",_);const m=new FileReader;m.onload=f=>{var y;n.value=((y=f.target)==null?void 0:y.result)||""},m.readAsDataURL(t.files[0])}};return(e,t)=>(v(),g("div",null,[s("div",{class:h(["flex items-center mb-2",d(a)])},[s("label",{for:c.id,class:h(["block font-bold tracking-wide",[{"cursor-pointer":c.id}]]),textContent:V(c.label)},null,10,z),F(e.$slots,"label",{},void 0,!0)],2),s("div",{class:h(["relative border border-gray-300 border-opacity-40 rounded dark:bg-white/[0.05] bg-gray-100",{model:!d(n)}])},[d(n).length>0?(v(),g("div",A,[s("img",{class:"preview w-full h-full",src:d(n)},null,8,H)])):(v(),g("div",M," 點擊上傳圖片 ")),s("input",{id:c.id,type:"file",accept:"image/*",class:"absolute w-full h-full cursor-pointer opacity-0 top-0 left-0",required:c.required,onChange:l},null,40,Q)],2)]))}});const K=I(E,[["__scopeId","data-v-d10ebd38"]]),T={class:"container"},G=q('<h1 data-v-e8e35f0f> jQuery Image Upload <small data-v-e8e35f0f>with preview</small></h1><div class="avatar-upload" data-v-e8e35f0f><div class="avatar-edit" data-v-e8e35f0f><input type="file" id="imageUpload" accept=".png, .jpg, .jpeg" data-v-e8e35f0f><label for="imageUpload" data-v-e8e35f0f></label></div><div class="avatar-preview" data-v-e8e35f0f><div id="imagePreview" style="background-image:url(http://i.pravatar.cc/500?img=7);" data-v-e8e35f0f></div></div></div>',2),J=[G],O=w({__name:"Uploader",setup(c){const o=async a=>{if(a.files&&a.files[0]){var r=new FileReader;r.onload=function(i){var l;$("#imagePreview").css("background-image","url("+((l=i.target)==null?void 0:l.result)+")"),$("#imagePreview").hide(),$("#imagePreview").fadeIn(650)},console.log(a.files[0]),await u(a.files[0]),r.readAsDataURL(a.files[0])}},n=b("message"),u=async a=>{const r=new FormData;r.append("file",a);const{data:i,error:l,message:e}=await U("/comm/upload",{body:r,multipart:!0});return l?n.value=e:i};return D(()=>{$("#imageUpload").on("change",function(){o(this)})}),(a,r)=>(v(),g("div",T,J))}});const W=I(O,[["__scopeId","data-v-e8e35f0f"]]),X={class:"flex items-center justify-between sticky"},Y={class:"flex items-center space-x-2"},Z=s("h1",{class:"text-xl font-bold"},"身份驗證",-1),ee=s("span",{class:"lg:pr-2 duration-150 pr-1"}," 送出 ",-1),te={class:"py-3"},se=w({__name:"identity-verify",setup(c){const o=k({idCard:"",positive:null,negative:null}),n=b("loading"),u=b("alert"),a=R(),r=async()=>{n.value=!0;const{error:l,message:e}=await U("/user/identity-verify",{body:o,multipart:!0});if(n.value=!1,l&&e)return u.value={type:"error",text:e,center:!0};const{user:t}=L();return t.updateField({identityStatus:21,idCard:o.idCard}),u.value={type:"success",text:"送出成功，等待管理員審核",center:!0,action:()=>a.push("/my/account")}},i=()=>{if(!o.positive)return u.value={type:"error",text:"尚未上傳照片",center:!0};r()};return(l,e)=>{const t=P,_=N,m=K,f=W,y=j;return v(),g("div",null,[s("div",X,[s("div",Y,[s("div",{class:"flex items-center cursor-pointer",onClick:e[0]||(e[0]=x=>l.$router.go(-1))},[p(t,{class:"i-ic-round-arrow-back-ios text-sm lg:text-base"})]),Z]),s("div",{class:"group rounded-full cursor-pointer bg-green-500 text-white font-bold px-4 lg:h-9 lg:leading-9 h-7 leading-7 flex items-center lg:text-base text-sm",onClick:i},[ee,p(t,{class:"i-ic-round-arrow-forward-ios"})])]),s("div",te,[p(y,{class:"max-w-[28em]",onSubmit:i},{default:B(()=>[p(_,{modelValue:d(o).idCard,"onUpdate:modelValue":e[1]||(e[1]=x=>d(o).idCard=x),label:"身分證/護照",class:"mb-5",require:!0},null,8,["modelValue"]),p(m,{id:"positive",modelValue:d(o).positive,"onUpdate:modelValue":e[2]||(e[2]=x=>d(o).positive=x),label:"照片",class:"mb-5",require:!0},null,8,["modelValue"]),p(f)]),_:1})])])}}});export{se as default};
