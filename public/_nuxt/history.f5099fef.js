import{g as F,s as u,i as L,I as N,L as y,y as A,o as i,c,a as n,b as g,F as b,E as D,k as t,G as h,V as x,W as f,H as E,n as H,t as I}from"./entry.3fc94d53.js";import{_ as R}from"./Row.28b8a3c1.js";import{_ as S}from"./Row.vue.925a0e9c.js";import"./RowLoading.9c0b152c.js";const G={class:"flex items-center sticky mb-3"},M=n("h1",{class:"text-lg lg:text-xl font-bold"},"瀏覽紀錄",-1),P={class:"flex flex-wrap items-center space-x-4 text-sm mb-3"},T=["onClick"],U={class:"py-3"},W={key:0},j={key:1},q=n("p",null,"載入更多",-1),J=[q],K={class:"text-center pt-8 text-xs font-bold tracking-widest opacity-50"},k=10,et=F({__name:"history",async setup(O){let p,m;const r=u([]),e=u({}),w=u([{label:"新聞",value:"article"},{label:"小知識",value:"tip"}]),l=u("article"),o=u(!0),v=L(()=>e.value.total<=e.value.size*e.value.page);try{const{data:s}=([p,m]=N(()=>y("/my/history",{body:{size:k,type:l.value}})),p=await p,m(),p);r.value=s.list,e.value=s.pagination,o.value=!1}catch{}const C=()=>{r.value=[],e.value={}};A(l,async s=>{o.value=!0,C();const{data:a}=await y("/my/history",{body:{size:k,type:s}});r.value=a.list,e.value=a.pagination,o.value=!1});const z=async()=>{if(v.value||o.value)return;o.value=!0;const s=e.value.page,a=e.value.size,{data:_}=await y("/my/history",{body:{size:a,page:s}});r.value.push(..._.list),e.value=_.pagination,o.value=!1};return(s,a)=>{const _=E,$=R,V=S;return i(),c("div",null,[n("div",G,[n("div",{class:"lg:hidden mr-2 flex items-center cursor-pointer",onClick:a[0]||(a[0]=d=>s.$router.go(-1))},[g(_,{class:"i-ic-round-arrow-back-ios text-sm lg:text-base"})]),M]),n("div",P,[(i(!0),c(b,null,D(t(w),(d,B)=>(i(),c("div",{key:B,class:H(["cursor-pointer h-8 leading-8 px-5 border border-gray-200 dark-border-opacity-20 rounded-full duration-200",{"bg-gray-200 dark:bg-opacity-10":t(l)===d.value}]),onClick:Q=>l.value=d.value},I(d.label),11,T))),128))]),n("div",U,[t(l)==="article"?(i(),c("div",W,[g($,{tag:"h3",list:t(r)??[],infinite:!0,loading:t(o)},null,8,["list","loading"])])):t(l)==="tip"?(i(),c("div",j,[g(V,{list:t(r)??[]},null,8,["list"])])):h("",!0),t(o)?h("",!0):(i(),c(b,{key:2},[x(n("div",{class:"dark:text-gray-400 block border-t py-4 mt-3 font-bold text-center text-xs text-gray-500 border-gray-200 dark:border-gray-800 duration-300 border-b hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer",onClick:a[1]||(a[1]=d=>z())},J,512),[[f,!t(v)]]),x(n("div",K," 無更多資料... ",512),[[f,t(v)]])],64))])])}}});export{et as default};
