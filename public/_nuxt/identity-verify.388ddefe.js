import{d as C,r as k,G as $,Q as V,u as f,o as g,c as x,a as s,n as y,t as I,q,h as a,m as S,_ as F,C as h,D as U,E as w,g as p,w as D,p as B,H as R,K as z}from"./entry.c5c9e8cb.js";const A=["for","textContent"],E={key:0},H=["src"],L={key:1,class:"p-c text-xs"},N=["id","required"],T=C({__name:"Image",props:{modelValue:{type:String,default:""},label:{type:String,default:""},id:{type:String,default:""},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,{emit:o}){const r=k(""),c=$({lg:"text-base",md:"text-sm",sm:"text-xs",xs:"text-xs"}),v=V(()=>c.md),b=f("message"),_=async e=>{const t=new FormData;t.append("file",e);const{data:u,error:d,message:m}=await S("/comm/upload",{body:t,multipart:!0});return d?b.value=m:u},n=async e=>{const t=e.target;if(t.files&&t.files[0]){const u=await _(t.files[0]);o("update:modelValue",u);const d=new FileReader;d.onload=m=>{var l;r.value=((l=m.target)==null?void 0:l.result)||""},d.readAsDataURL(t.files[0])}};return(e,t)=>(g(),x("div",null,[s("div",{class:y(["flex items-center mb-2",a(v)])},[s("label",{for:i.id,class:y(["block font-bold tracking-wide",[{"cursor-pointer":i.id}]]),textContent:I(i.label)},null,10,A),q(e.$slots,"label",{},void 0,!0)],2),s("div",{class:y(["relative border border-gray-300 border-opacity-40 rounded dark:bg-white/[0.05] bg-gray-100",{model:!a(r)}])},[a(r).length>0?(g(),x("div",E,[s("img",{class:"preview w-full h-full",src:a(r)},null,8,H)])):(g(),x("div",L," 點擊上傳圖片 ")),s("input",{id:i.id,type:"file",accept:"image/*",class:"absolute w-full h-full cursor-pointer opacity-0 top-0 left-0",required:i.required,onChange:n},null,40,N)],2)]))}});const j=F(T,[["__scopeId","data-v-d10ebd38"]]),G={class:"flex items-center justify-between sticky"},K={class:"flex items-center space-x-2"},P=s("h1",{class:"text-xl font-bold"},"身份驗證",-1),Q=s("span",{class:"lg:pr-2 duration-150 pr-1"}," 送出 ",-1),J={class:"py-3"},O=C({__name:"identity-verify",setup(i){{const{user:n}=h(),{isLogin:e}=U(n),t=f("showAuth");e.value||(t.value=!0,w().replace("/"))}const o=$({idCard:"",positive:null}),r=f("loading"),c=f("alert"),v=w(),b=async()=>{r.value=!0;const{error:n,message:e}=await S("/user/identity-verify",{body:o,multipart:!0});if(r.value=!1,n&&e)return c.value={type:"error",text:e,center:!0};const{user:t}=h();return t.updateField({identityStatus:21,idCard:o.idCard}),c.value={type:"success",text:"送出成功，等待管理員審核",center:!0,action:()=>v.push("/my/account")}},_=()=>{if(!o.positive)return c.value={type:"error",text:"尚未上傳照片",center:!0};b()};return(n,e)=>{const t=B,u=z,d=j,m=R;return g(),x("div",null,[s("div",G,[s("div",K,[s("div",{class:"flex items-center cursor-pointer",onClick:e[0]||(e[0]=l=>n.$router.go(-1))},[p(t,{class:"i-ic-round-arrow-back-ios text-sm lg:text-base"})]),P]),s("div",{class:"group rounded-full cursor-pointer bg-green-500 text-white font-bold px-4 lg:h-9 lg:leading-9 h-7 leading-7 flex items-center lg:text-base text-sm",onClick:_},[Q,p(t,{class:"i-ic-round-arrow-forward-ios"})])]),s("div",J,[p(m,{class:"max-w-[28em]",onSubmit:_},{default:D(()=>[p(u,{modelValue:a(o).idCard,"onUpdate:modelValue":e[1]||(e[1]=l=>a(o).idCard=l),label:"身分證/護照",class:"mb-5",require:!0},null,8,["modelValue"]),p(d,{id:"positive",modelValue:a(o).positive,"onUpdate:modelValue":e[2]||(e[2]=l=>a(o).positive=l),label:"照片",class:"mb-5",require:!0},null,8,["modelValue"])]),_:1})])])}}});export{O as default};
