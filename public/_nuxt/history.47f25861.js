import{d as N,r as u,Q as R,R as S,m as y,S as V,o as i,c,a as n,g as m,F as b,b as A,h as t,e as h,k as x,v as f,p as D,n as L,t as E}from"./entry.bfc9bcac.js";import{_ as H}from"./Row.9786dd3a.js";import{_ as I}from"./Row.vue.26241bdf.js";import"./RowLoading.d4e7a80a.js";const M={class:"flex items-center sticky mb-3"},P=n("h1",{class:"text-lg lg:text-xl font-bold"},"瀏覽紀錄",-1),Q={class:"flex flex-wrap items-center space-x-4 text-sm mb-3"},T=["onClick"],U={class:"py-3"},j={key:0},q={key:1},G=n("p",null,"載入更多",-1),J=[G],K={class:"text-center pt-8 text-xs font-bold tracking-widest opacity-50"},k=10,et=N({__name:"history",async setup(O){let p,g;const r=u([]),e=u({}),w=u([{label:"新聞",value:"article"},{label:"小知識",value:"tip"}]),l=u("article"),o=u(!0),v=R(()=>e.value.total<=e.value.size*e.value.page);try{const{data:s}=([p,g]=S(()=>y("/my/history",{body:{size:k,type:l.value}})),p=await p,g(),p);r.value=s.list,e.value=s.pagination,o.value=!1}catch{}const C=()=>{r.value=[],e.value={}};V(l,async s=>{o.value=!0,C();const{data:a}=await y("/my/history",{body:{size:k,type:s}});r.value=a.list,e.value=a.pagination,o.value=!1});const z=async()=>{if(v.value||o.value)return;o.value=!0;const s=e.value.page,a=e.value.size,{data:_}=await y("/my/history",{body:{size:a,page:s}});r.value.push(..._.list),e.value=_.pagination,o.value=!1};return(s,a)=>{const _=D,$=H,B=I;return i(),c("div",null,[n("div",M,[n("div",{class:"lg:hidden mr-2 flex items-center cursor-pointer",onClick:a[0]||(a[0]=d=>s.$router.go(-1))},[m(_,{class:"i-ic-round-arrow-back-ios text-sm lg:text-base"})]),P]),n("div",Q,[(i(!0),c(b,null,A(t(w),(d,F)=>(i(),c("div",{key:F,class:L(["cursor-pointer h-8 leading-8 px-5 border border-gray-200 dark-border-opacity-20 rounded-full duration-200",{"bg-gray-200 dark:bg-opacity-10":t(l)===d.value}]),onClick:W=>l.value=d.value},E(d.label),11,T))),128))]),n("div",U,[t(l)==="article"?(i(),c("div",j,[m($,{tag:"h3",list:t(r)??[],infinite:!0,loading:t(o)},null,8,["list","loading"])])):t(l)==="tip"?(i(),c("div",q,[m(B,{list:t(r)??[]},null,8,["list"])])):h("",!0),t(o)?h("",!0):(i(),c(b,{key:2},[x(n("div",{class:"dark:text-gray-400 block border-t py-4 mt-3 font-bold text-center text-xs text-gray-500 border-gray-200 dark:border-gray-800 duration-300 border-b hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer",onClick:a[1]||(a[1]=d=>z())},J,512),[[f,!t(v)]]),x(n("div",K," 無更多資料... ",512),[[f,t(v)]])],64))])])}}});export{et as default};
